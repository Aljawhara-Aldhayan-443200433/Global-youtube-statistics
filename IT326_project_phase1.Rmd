---
output: html_notebook
---
#IT326 Project




# Description:

This dataset, obtained from vgchartz.com, provides a valuable resource for exploring the dynamics between gaming platforms and genres in the top 100 global video games. It enables us to analyze the platforms that are influencing worldwide sales, identify the most prosperous genres in various global regions, and track the evolving trends in both platform preference and genre popularity over time. 



# Goal:

Our goal  from studying this dataset is to utilize classification and clustering techniques on the input data to make predictions about the popularity of upcoming games.




# Attributes discerption:

this dataset has 11 attributes and 16599 objects.

Rank: Ranking of the game based on global sales. 
Name: Name of the game. 
Platform: Platform the game was released on. 
Year: Year the game was released. 
Genre: Genre of the game.
Publisher: Publisher of the game. 
NA_Sales: Sales of the game in North America. 
EU_Sales: Sales of the game in Europe. 
JP_Sales: Sales of the game in Japan. 
Other_Sales: Sales of the game in other regions. 
Global_Sales: Total sales of the game worldwide.


# Class label:

Our class label is “Popular”: it predicts whether a game will sell 1000000 or more globally (regression).


# import dataset
dataset=read.csv("vgsales.csv")

# libraries
library(outliers) 
library(dplyr)
library(Hmisc)
library(ggplot2)
library(cowplot)
library(mlbench)
library(caret)
library(faux)
library(DataExplorer)
library(randomForest)
options(max.print=9999999)


# dataset info
dim(dataset)
names(dataset)

# dataset structure
str(dataset)

# sample of raw dataset(first 10 rows)
head(dataset, 10)

# sample of raw dataset(last 10 rows)
tail(dataset, 10)

# summary of dataset
summary(dataset)

# variance of numeric data
var(dataset$NA_Sales)
var(dataset$EU_Sales)
var(dataset$JP_Sales)
var(dataset$Other_Sales)
var(dataset$Global_Sales)

# platform pie chart:

```{r}

tab <- dataset2$Platform %>% table()
precentages <- tab %>% prop.table() %>% round(3) * 100 
txt <- paste0(names(tab), '\n', precentages, '%') 
pie(tab, labels=txt) 

```


We notice from the pie chart of platform attribute that releasing a game for PS users will increase the popularity of the game since it is the most common platform among gamers. 



# Popular genres 
dataset$Genre %>% table() %>% barplot() 

# coloring barplot and adding text
tab<-dataset$Genre %>% table() 

precentages<-tab %>% prop.table() %>% round(3)*100 

txt<-paste0(names(tab), '\n',precentages,'%') 

bb <- dataset$Genre %>% table() %>% barplot(axisnames=F,main='Genre',ylab='count',col=c('pink','blue','lightblue','green','lightgreen','red','orange','red','grey','yellow','azure','olivedrab')) 

text(bb,tab/2,labels=txt,cex=1.5) 

# In terms of genre, action games are the most popular, followed by sports and music games. It is safe to assume that a high number of genres of this nature exist due to their popularity and sales.

# boxPlot for NA_Sales
boxplot(dataset$NA_Sales)

# boxPlot for EU_Sales
boxplot(dataset$EU_Sales)

# boxPlot for JP_Sales
boxplot(dataset$JP_Sales)



# boxPlot for Other_Sales

```{r}
boxplot(dataset$Other_Sales) 
```  

The boxplot of the Other-sales attribute indicate that the values are close to each other ,and there is a lot of outliers since the dataset represents the global sales of video games. 



# boxPlot for Global_Sales

```{r}
boxplot(dataset$Global_Sales)

```  
The boxplot of the Global-sales attribute indicate that the values are close to each other ,and there is a lot of outliers since the dataset represents the global sales of video games. 



# boxPlots for genre and Global_Sales
qplot(data = dataset, x=Global_Sales,y=Genre,fill=I("yellow"),width=0.5 ,geom = "boxplot")

# barplot for year
dataset$Year %>% table() %>% barplot()

# A matrix of sales Scatter plots
```{r}
pairs(~NA_Sales + EU_Sales + JP_Sales + Other_Sales + Global_Sales, data = dataset,
      main = "Sales Scatterplot")
```    
# We used Scatterplot to determine the type of correlation we have between the sales; we can see that the majority have positive correlation with each other. 
 
 
      
# Pre - processing

# Rank should be char and not numeric,because we will use them as ordinal data.
dataset$Rank=as.character(dataset$Rank)

# checking for nulls in name (there is no nulls)
sum(is.na(dataset$Name))
NullName<-dataset[dataset$Name=="N/A",]
NullName
# checking for nulls in Platform
sum(is.na(dataset$Platform))
NullPlatform<-dataset[dataset$Platform=="N/A",]

# Encoding categorical data for platform
dataset$Platform=factor(dataset$Platform,levels=c("2600","3DO","3DS","DC","DS","GB","GBA","GC","GEN","GG","N64","NES","NG","PC","PCFX","PS","PS2","PS3","PS4","PSP","PSV","SAT","SCD","SNES","TG16","Wii","WiiU","WS","X360","XB","XOne"), labels=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31))

# Encoding categorical data for Genre
```{r}
dataset$Genre=factor(dataset$Genre,levels=c("Action","Adventure","Fighting","Platform","Puzzle","Racing","Role-Playing","Shooter","Simulation","Sports","Strategy","Misc"),labels=c(1,2,3,4,5,6,7,8,9,10,11,12))
```
# checking for nulls in year
sum(is.na(dataset$year))
NullYear<-dataset[dataset$Year=="N/A",]
NullYear
# we won't delete the null and we will leave them as global constant as it is because we want the sales data of them.

# checking for nulls in Genre(there is no nulls)
sum(is.na(dataset$Genre))
NullGenre<-dataset[dataset$Genre=="N/A",]
NullGenre

# checking for nulls in Publisher(there is no nulls)
sum(is.na(dataset$Publisher))
NullPublisher<-dataset[dataset$Publisher=="N/A",]
NullPublisher
# we won't delete the null and we will leave them as global constant as it is because we want the sales data of them.

# dataset before normalization
datsetWithoutNormalization<-dataset

# Z_normalization
Z_normalize <- function(x) {return ((x - mean(x)) / sd(x))} 
dataset$NA_Sales<-Z_normalize(datsetWithoutNormalization$NA_Sales) 
dataset$EU_Sales<-Z_normalize(datsetWithoutNormalization$EU_Sales) 
dataset$JP_Sales<-Z_normalize(datsetWithoutNormalization$JP_Sales) 
dataset$Other_Sales<-Z_normalize(datsetWithoutNormalization$Other_Sales) 
dataset$Global_Sales<-Z_normalize(datsetWithoutNormalization$Global_Sales)

# min-max normalization
normalize <- function(x) {return ((x - min(x)) / (max(x) - min(x)))}
dataset$NA_Sales<-normalize(datsetWithoutNormalization$NA_Sales)
dataset$EU_Sales<-normalize(datsetWithoutNormalization$EU_Sales)
dataset$JP_Sales<-normalize(datsetWithoutNormalization$JP_Sales)
dataset$Other_Sales<-normalize(datsetWithoutNormalization$Other_Sales)
dataset$Global_Sales<-normalize(datsetWithoutNormalization$Global_Sales)
# we will use the min-max normalization; it's better for visualization.

# use roc_curve area as score
roc_imp <- filterVarImp(x = dataset[,7:10], y = dataset$Global_Sales)
# sort the score in decreasing order
roc_imp <- data.frame(cbind(variable = rownames(roc_imp), score = roc_imp[,1]))
roc_imp$score <- as.double(roc_imp$score)
roc_imp[order(roc_imp$score,decreasing = TRUE),]

# we will rmove the (JP_Sales) because it is of low importance to our class_label(Global_Sales)
dataset<- dataset[,-9]







#outlier of NA_Sales
OutNA_Sales = outlier(dataset$NA_Sales, logical =TRUE)
sum(OutNA_Sales)
Find_outlier = which(OutNA_Sales ==TRUE, arr.ind = TRUE)
OutNA_Sales
Find_outlier
#outlier of EU_Sales
OutEU_Sales = outlier(dataset$EU_Sales, logical =TRUE)
sum(OutEU_Sales)
Find_outlier = which(OutEU_Sales ==TRUE, arr.ind = TRUE)
OutEU_Sales
Find_outlier
#outlier of JP_Sales
OutJP_Sales = outlier(dataset$JP_Sales, logical =TRUE)
sum(OutJP_Sales)
Find_outlier = which(OutJP_Sales ==TRUE, arr.ind = TRUE)
OutJP_Sales
Find_outlier


#outlier of other_sales 
```{r}
OutOS=outlier(dataset$Other_Sales, logical=TRUE)  
sum(OutOS)  
Find_outlier=which(OutOS==TRUE, arr.ind=TRUE)  
OutOS 
Find_outlier 

```
#outlier of Global_sales 

```{r}
OutGS=outlier(dataset$Global_Sales, logical=TRUE)  
sum(OutGS)  
Find_outlier=which(OutGS==TRUE, arr.ind=TRUE)  
OutGS 
Find_outlier 

```



#remove outliers 
dataset= dataset[-Find_outlier,]




